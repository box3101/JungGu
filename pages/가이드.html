<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/css/swiper.min.css">
  <link rel="stylesheet" href="../front/css/guide.css">
  <script src="../front/js/swiper.js"></script>
</head>

<body>
  <div class="guideBox">
    <div class="header">
      접근성 스와이퍼 슬라이드
    </div>
    <div class="info">
      <!-- 슬라이드의 이전, 다음 버튼이 있어 키보드로 이전, 다음 슬라이드의 접근이 가능해야 한다 -->
      <!-- 총 몇 장의 슬라이드 중 현재 활성화된 슬라이드가 몇 번째 슬라이드 인지 확인 할 수 있는 인디게이터가 있어야 한다. -->
      <!-- 자동 재생 슬라이드 일 경우 정지 버튼을 포함하고 있어야 한다. -->
      <!-- 키보드 tab, back tab으로 모든 슬라이드 접근이 가능하여야 한다. -->
      <!-- 무한 루프 형식의 슬라이드는 해당 슬라이드에서 포커스가 벗어날 수 없으면 웹 접근성에 위배된다. (무한 루프 옵션을 사용 시 키보드 탭 동작 또는 화살표 키 동작으로 해당 영역을 벗어날 수 있는지 확인 필요. 없다면
      별도로 작업해주어야 함) -->

      <!-- 클래스명은 변경하면 안 됨 -->

      <div class="guideSwiper">
        <div class="swiper-button-next"></div><!-- 다음 버튼 (오른쪽에 있는 버튼) -->
        <div class="swiper-container">
          <div class="swiper-wrapper">
            <div class="swiper-slide">
              <a href="#">
                <img src="http://oldmidi.cdn3.cafe24.com/p/0212.jpg">
              </a>
            </div>
            <div class="swiper-slide">
              <a href="#">
                <img src="http://oldmidi.cdn3.cafe24.com/p/0213.jpg">
              </a>
            </div>
            <div class="swiper-slide">
              <a href="#">
                <img src="http://oldmidi.cdn3.cafe24.com/p/0214.jpg">
              </a>
            </div>
          </div>
        </div>
        <div class="swiper-button-prev"></div><!-- 이전 버튼 -->
        <!-- 시작,정지 -->
        <div class="autoplay-control">
          <button aria-pressed="false" aria-label="자동 재생 일시 정지"></button>
        </div>
      </div>

      <script>
        const changeTabIndex = () => {
          $$swiperAll = document.querySelectorAll(".swiper-slide");
          $$swiperAll.forEach((el, idx) => {
            const $swiperAnchor = el.querySelector("a");
            if (el.classList.contains("swiper-slide-active")) {
              $swiperAnchor.setAttribute("tabindex", "0");
            } else {
              $swiperAnchor.setAttribute("tabindex", "-1");
            }
          });
        }

        new Swiper('.swiper-container', {
          autoplay: {
            delay: 1000,
          },
          loop: true,
          navigation: {
            nextEl: '.swiper-button-next', // 다음 버튼 클래스명
            prevEl: '.swiper-button-prev', // 이번 버튼 클래스명
          },
          a11y: {
            prevSlideMessage: '이전 슬라이드',
            nextSlideMessage: '다음 슬라이드',
            slideLabelMessage: '총 {{slidesLength}}장의 슬라이드 중 {{index}}번 슬라이드 입니다.',
          },
          on: {
            init: function () {
              changeTabIndex();
              thisSlide = this;
              autoPlayBtn = document.querySelector('.autoplay-control > button');
              autoPlayBtn.addEventListener('click', (e) => {
                autoPlayState = autoPlayBtn.getAttribute('aria-pressed');
                if (autoPlayState === 'false') {
                  autoPlayBtn.setAttribute('aria-pressed', 'true');
                  thisSlide.autoplay.stop();
                } else if (autoPlayState === 'true') {
                  autoPlayBtn.setAttribute('aria-pressed', 'false');
                  thisSlide.autoplay.start();
                };
              });
            },
            slideChangeTransitionStart: () => {
              changeTabIndex();
            }
          },

        });
      </script>
    </div>


</body>

</html>